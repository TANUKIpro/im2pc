# 概要
π³ / Pi3X と SAM を組み合わせて“物体のマスク付き多視点再構成”を行うためのリポジトリです。詳細は`.claude/concepts.md`および`.claude/architecture.md`を読んでください

# ルール

## ドキュメント
必ず最初に以下のドキュメントを読むこと
- `claude/concepts.md`
- (必要に応じて) `.claude/architecture.md`

## 設計フェーズの運用ルール（Spec→MVP thin slice）

### 進め方
- まず AskUserQuestion で“ブレると手戻りが大きい判断”だけを集中的に聞く（UI/UX、データ、権限、失敗時、トレードオフ）。
- 回答が揃ったら SPEC.md を作成し、設計を固定してから実装へ（実装は新セッション推奨）。

### SPEC.md テンプレ（最小）
- Goal（何を達成？）
- Non-Goals（今回やらないこと）
- MVP thin slice（ユーザーが完了できる最小の一連の流れを1本）
- Success Criteria（どう検証する？テスト/期待出力/スクショ 等）
- Constraints（期限/技術/互換性/運用）
- Open Questions（未決の判断。ここだけ AskUserQuestion の対象）

### MVPルール
- 「縦切りで1本通す」以外は後回し（最適化/汎用化/追加設定/管理画面/例外網羅など）
- 次イテレーション候補は“学びが最大の順”に最大3つまで列挙


## 実装フェーズの運用ルール（MVP駆動）

### 絶対守る
- まず「成功条件（検証方法）」を1つ以上作る。テスト / lint / 型チェック / 期待出力 / スクショ比較のいずれか。検証できない実装は禁止。
- 調査→計画→実装→コミットを混ぜない（Explore/Plan/Implement/Commit）。不確実ならPlan Mode相当で先に調査と計画を出す。
- MVPは「thin slice（ユーザーが一連の流れを完了できる最小）」を1本だけ通す。付加機能・最適化・抽象化は後回し（YAGNI）。
- 迷ったら AskUserQuestion を使う。ただし“ブロッカーのみ”質問し、軽微な選択は合理的な仮定で進め、最後に「仮定リスト」を提示する。
  - AskUserQuestion が不発/不安定な場合は、通常メッセージで質問→回答を受けて続行（フェイルセーフ）。

### デフォルトの進め方（毎回この順）
1. サブエージェントで調査（既存実装/類似パターン/影響範囲）→要点だけ報告
2. 5〜10行の実装プラン（変更ファイル、API、テスト、ロールバック）を作成
3. 実装は「小さな差分」で、動くところまで到達（thin slice）
4. 検証コマンドを実行して結果を貼る。失敗したら修正して再実行を繰り返す
5. 変更点サマリ（何を/なぜ/どう検証したか）＋次の一手（MVP後の候補）を出す

### サブエージェントの役割（デフォルト）
- 指揮（あなた）: スコープ制御、MVP判定、仮定管理、最終報告
- コーディング: 実装・最小差分・既存規約遵守
- 品質チェック: 境界条件/セキュリティ/可読性/過剰実装検出（MVP逸脱を止める）
- 実行: テスト/lint/build/e2e等を回し、ログ要点を返す

### コンテキスト最適化
- 調査はサブエージェントに寄せてメイン会話を汚さない
- コンパクト/要約時に「変更ファイル一覧」「実行した検証コマンド」「未解決TODO」を必ず残す
